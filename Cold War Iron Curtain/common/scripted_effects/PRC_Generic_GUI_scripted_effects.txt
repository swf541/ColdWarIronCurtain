#更改政治局党内团结和纪律调用
    #纪律 PRC_CCCPC_party_discipline_change_temp
PRC_CCCPC_party_discipline_add = {
    custom_effect_tooltip = PRC_CCCPC_party_discipline_add_tt
    add_to_variable = {
        PRC_party_discipline = PRC_CCCPC_party_discipline_change_temp
    }
    round_temp_variable = PRC_CCCPC_party_discipline_change_temp
    PRC_CCCPC_party_status_update = yes
}
PRC_CCCPC_party_discipline_sub = {
    custom_effect_tooltip = PRC_CCCPC_party_discipline_sub_tt
    subtract_from_variable = {
        PRC_party_discipline = PRC_CCCPC_party_discipline_change_temp
    }
    round_temp_variable = PRC_CCCPC_party_discipline_change_temp
    PRC_CCCPC_party_status_update = yes
}
    #团结度 PRC_CCCPC_party_unity_change_temp
PRC_CCCPC_party_unity_add = {
    custom_effect_tooltip = PRC_CCCPC_party_unity_add_tt
    add_to_variable = {
        PRC_party_unity = PRC_CCCPC_party_unity_change_temp
    }
    round_temp_variable = PRC_CCCPC_party_unity_change_temp
    PRC_CCCPC_party_status_update = yes
}
PRC_CCCPC_party_unity_sub = {
    custom_effect_tooltip = PRC_CCCPC_party_unity_sub_tt
    subtract_from_variable = {
        PRC_party_unity = PRC_CCCPC_party_unity_change_temp
    }
    round_temp_variable = PRC_CCCPC_party_unity_change_temp
    PRC_CCCPC_party_status_update = yes
}
    #mkl版本
PRC_CCCPC_party_unity_update = {
	custom_effect_tooltip = PRC_CCCPC_party_unity_change_tt
	add_to_variable = {
		var =  PRC_party_unity
		value = temp_party_unity
	}
    PRC_CCCPC_party_status_update = yes
}
PRC_CCCPC_party_discipline_update = {
	custom_effect_tooltip = PRC_CCCPC_party_discipline_change_tt
	add_to_variable = {
		var =  PRC_party_discipline
		value = temp_party_discipline
	}
    PRC_CCCPC_party_status_update = yes
}
#新政治局系统
PRC_CCCPC_gui_update = {
	clear_array = PRC_CCCPC_leaders_influence_gui_array
	for_each_loop = {
        array = PRC_CCCPC_leaders_array
        index = temp_i
        
		set_temp_variable = { PRC_CCCPC_leaders_influence_temp = PRC_CCCPC_leaders_influence_array^temp_i }
        round_temp_variable = PRC_CCCPC_leaders_influence_temp
         
		for_loop_effect = {
			start = 0
			end = PRC_CCCPC_leaders_influence_temp
            
			add_to_array = { PRC_CCCPC_leaders_influence_gui_array = PRC_CCCPC_leaders_array^temp_i }
        }
    }
}
PRC_CCCPC_leaders_influence_update = {
	custom_effect_tooltip = PRC_CCCPC_leaders_influence_change_tt
	for_each_loop = {
        array = PRC_CCCPC_leaders_array
        index = temp_i
		value = temp_v2
        
		if = {
			limit = {
				check_variable = { temp_v2 = temp_v }
			}
			add_to_variable = {
				var =  PRC_CCCPC_leaders_influence_array^temp_i 
				value = temp_influence
			}
		}
    }
    PRC_CCCPC_gui_update = yes
}
PRC_CCCPC_party_unity_update = {
	custom_effect_tooltip = PRC_CCCPC_party_unity_change_tt
	add_to_variable = {
		var =  PRC_party_unity
		value = temp_party_unity
	}
    PRC_CCCPC_party_status_update = yes
}
PRC_CCCPC_party_discipline_update = {
	custom_effect_tooltip = PRC_CCCPC_party_discipline_change_tt
	add_to_variable = {
		var =  PRC_party_discipline
		value = temp_party_discipline
	}
    PRC_CCCPC_party_status_update = yes
}
PRC_CCCPC_party_status_update = {
     #party status#
	set_variable = { PRC_CPC_political_power_gain = 0 }
	set_variable = { PRC_CPC_stability_factor = 0 }
	set_variable = { PRC_CPC_drift_defence_factor = 0 }

	set_temp_variable = { temp_status1 = PRC_party_unity }#
	subtract_from_temp_variable = { temp_status1 = 60 }
	set_temp_variable = { temp_status2 = temp_status1 }
	if = {
		limit = { check_variable = { temp_status2 < 0 } }
		multiply_temp_variable = { temp_status2 = -1 }
	}
	add_to_temp_variable = { temp_status2 = 40 }
	divide_temp_variable = { temp_status1 = temp_status2 }
    
	multiply_temp_variable = { temp_status1 = 0.4 }#
	add_to_variable = { PRC_CPC_political_power_gain = temp_status1 }
	divide_temp_variable = { temp_status1 = 0.4 }
	multiply_temp_variable = { temp_status1 = 0.3 }
	add_to_variable = { PRC_CPC_stability_factor = temp_status1 }
	divide_temp_variable = { temp_status1 = 0.3 }
    multiply_temp_variable = { temp_status1 = 0.6 }
	add_to_variable = { PRC_CPC_drift_defence_factor = temp_status1 }

	set_temp_variable = { temp_status1 = PRC_party_discipline }#
	subtract_from_temp_variable = { temp_status1 = 60 }
	set_temp_variable = { temp_status2 = temp_status1 }
	if = {
		limit = { check_variable = { temp_status2 < 0 } }
		multiply_temp_variable = { temp_status2 = -1 }
	}
	add_to_temp_variable = { temp_status2 = 40 }
	divide_temp_variable = { temp_status1 = temp_status2 }
      
	multiply_temp_variable = { temp_status1 = 0.4 }#
	add_to_variable = { PRC_CPC_political_power_gain = temp_status1 }
	divide_temp_variable = { temp_status1 = 0.4 }
	multiply_temp_variable = { temp_status1 = 0.2 }
	add_to_variable = { PRC_CPC_stability_factor = temp_status1 }

	force_update_dynamic_modifier = yes
}
PRC_CCCPC_gui_startup = {
	set_country_flag = PRC_Seventh_Central_Committee_of_CPC

	clear_array = PRC_CCCPC_leaders_array
	clear_array = PRC_CCCPC_Political_Bureau_array
    #clear_array = PRC_CCCPC_Political_Bureau_frame_array
	clear_array = PRC_CCCPC_leaders_influence_array

	add_to_array = { PRC_CCCPC_leaders_array = 1 }
	add_to_array = { PRC_CCCPC_leaders_array = 2 }
	add_to_array = { PRC_CCCPC_leaders_array = 3 }
	add_to_array = { PRC_CCCPC_leaders_array = 4 }
    #政治局设定
    PRC_CCCPC_Political_Bureau_array_Set_1945 = yes

	add_to_array = { PRC_CCCPC_leaders_influence_array = 48.2 }
	add_to_array = { PRC_CCCPC_leaders_influence_array = 21 }
	add_to_array = { PRC_CCCPC_leaders_influence_array = 25.7 }
	add_to_array = { PRC_CCCPC_leaders_influence_array = 5.1 }

	set_variable = { PRC_party_discipline = 92 }
	set_variable = { PRC_party_unity = 90 }

	PRC_CCCPC_gui_update = yes

	PRC_CCCPC_party_status_update = yes
}
#历史政治局设定
PRC_CCCPC_Political_Bureau_array_Set_1945 = {#中国共产党第七届中央领导机构（1945年4月至1956年8月）
    clear_array = PRC_CCCPC_Political_Bureau_array
    #头像设置（本地化同理）
    #-1透明  0椅子（空） 1薄一波 2陈伯达 3陈毅 4陈云 5邓小平 6董必武 7高岗 8贺龙 9康生 10柯庆施 11李井泉 
    #12李先念 13林彪 14林伯渠 15刘伯承 16刘少奇 17陆定一 18罗荣桓 19毛泽东 20彭德怀 21彭真 22任弼时 
    #23乌兰夫 24张闻天 25周恩来 26朱德
	#第一行
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 19 }#这里开始为常务/书记
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 26 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 16 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 25 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 22 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
    #第二行
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 4 }#这里开始为普通委员
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 9 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 7 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 21 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 6 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 13 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 24 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 20 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
    #第三行
    add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
    #第四行
    add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 0 }#这里开始为候补
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 0 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 0 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 0 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 0 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 0 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 0 }
}
PRC_CCCPC_Political_Bureau_array_Set_1956 = {#中国共产党第八届中央领导机构（1956年9月至1966年8月改组前）
    clear_array = PRC_CCCPC_Political_Bureau_array
    #头像设置（本地化同理）
    #-1透明  0椅子（空） 1薄一波 2陈伯达 3陈毅 4陈云 5邓小平 6董必武 7高岗 8贺龙 9康生 10柯庆施 11李井泉 
    #12李先念 13林彪 14林伯渠 15刘伯承 16刘少奇 17陆定一 18罗荣桓 19毛泽东 20彭德怀 21彭真 22任弼时 
    #23乌兰夫 24张闻天 25周恩来 26朱德 27李富春
	#第一行
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 19 }#这里开始为常委
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 16 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 25 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 26 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 4 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 5 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
    #第二行
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 14 }#这里开始为普通委员
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 6 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 21 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 18 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 3 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 27 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 20 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 15 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 8 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 12 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
    #第三行
    add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
    #第四行
    add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = -1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 23 }#这里开始为候补
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 24 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 17 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 2 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 9 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 1 }
	add_to_array = { PRC_CCCPC_Political_Bureau_array = 0 }
}
#旧政治局系统
PRC_faction_struggle_system_startup = {
    clear_array = PRC_faction_struggle_system_faction_influence

    add_to_array = { PRC_faction_struggle_system_faction_influence = 29 }
    add_to_array = { PRC_faction_struggle_system_faction_influence = 14 }
    add_to_array = { PRC_faction_struggle_system_faction_influence = 49 }
    add_to_array = { PRC_faction_struggle_system_faction_influence = 4 }
    add_to_array = { PRC_faction_struggle_system_faction_influence = 4 }

    clear_array = PRC_faction_struggle_system_faction_party_support
    clear_array = PRC_faction_struggle_system_faction_gov_support
    clear_array = PRC_faction_struggle_system_faction_army_support

    add_to_array = { PRC_faction_struggle_system_faction_party_support = 29 }
    add_to_array = { PRC_faction_struggle_system_faction_party_support = 14 }
    add_to_array = { PRC_faction_struggle_system_faction_party_support = 49 }
    add_to_array = { PRC_faction_struggle_system_faction_party_support = 4 }
    add_to_array = { PRC_faction_struggle_system_faction_party_support = 4 }

    add_to_array = { PRC_faction_struggle_system_faction_gov_support = 39 }
    add_to_array = { PRC_faction_struggle_system_faction_gov_support = 4 }
    add_to_array = { PRC_faction_struggle_system_faction_gov_support = 49 }
    add_to_array = { PRC_faction_struggle_system_faction_gov_support = 4 }
    add_to_array = { PRC_faction_struggle_system_faction_gov_support = 4 }

    add_to_array = { PRC_faction_struggle_system_faction_army_support = 0 }
    add_to_array = { PRC_faction_struggle_system_faction_army_support = 40 }
    add_to_array = { PRC_faction_struggle_system_faction_army_support = 50 }
    add_to_array = { PRC_faction_struggle_system_faction_army_support = 10 }
    add_to_array = { PRC_faction_struggle_system_faction_army_support = 0 }

    set_variable = { PRC_faction_struggle_system_party_united = 85 }
    set_variable = { PRC_faction_struggle_system_party_discipline = 90 }

    PRC_faction_struggle_system_gui_reflesh = yes

    clear_array = PRC_faction_struggle_system_faction_supporter_0
    clear_array = PRC_faction_struggle_system_faction_supporter_1
    clear_array = PRC_faction_struggle_system_faction_supporter_2
    clear_array = PRC_faction_struggle_system_faction_supporter_3
    clear_array = PRC_faction_struggle_system_faction_supporter_4

    add_to_array = { PRC_faction_struggle_system_faction_supporter_1 = 0 }
    add_to_array = { PRC_faction_struggle_system_faction_supporter_1 = 1 }
    add_to_array = { PRC_faction_struggle_system_faction_supporter_1 = 2 }

    add_to_array = { PRC_faction_struggle_system_faction_supporter_2 = 3 }

    add_to_array = { PRC_faction_struggle_system_faction_supporter_4 = 5 }
    add_to_array = { PRC_faction_struggle_system_faction_supporter_4 = 6 }
    add_to_array = { PRC_faction_struggle_system_faction_supporter_4 = 7 }

    clear_array = PRC_faction_struggle_system_faction_supporter_effect

    resize_array = {
		array = PRC_faction_struggle_system_faction_supporter_effect
		value = 0.1
		size = 9
	}

    PRC_faction_struggle_system_faction_supporter_effect_reflesh = yes
}

PRC_faction_struggle_system_gui_reflesh = {
    clear_array = PRC_faction_struggle_system_faction_party_support_frame
    clear_array = PRC_faction_struggle_system_faction_gov_support_frame
    clear_array = PRC_faction_struggle_system_faction_army_support_frame

    resize_array = {
		array = PRC_faction_struggle_system_faction_party_support_frame
		value = 0
		size = 5
	}
    resize_array = {
		array = PRC_faction_struggle_system_faction_gov_support_frame
		value = 0
		size = 5
	}
    resize_array = {
		array = PRC_faction_struggle_system_faction_army_support_frame
		value = 0
		size = 5
	}

    for_each_loop = {
        array = PRC_faction_struggle_system_faction_party_support
        index = index_y

        set_temp_variable = { index_x = index_y }
        add_to_temp_variable = { index_x = 1 }

        for_loop_effect = {
            start = 0
            end = index_x
            value = i

            add_to_variable = { PRC_faction_struggle_system_faction_party_support_frame^i = PRC_faction_struggle_system_faction_party_support^index_y }
        }
    }

    for_each_loop = {
        array = PRC_faction_struggle_system_faction_gov_support
        index = index_y

        set_temp_variable = { index_x = index_y }
        add_to_temp_variable = { index_x = 1 }

        for_loop_effect = {
            start = 0
            end = index_x
            value = i

            add_to_variable = { PRC_faction_struggle_system_faction_gov_support_frame^i = PRC_faction_struggle_system_faction_gov_support^index_y }
        }
    }

    for_each_loop = {
        array = PRC_faction_struggle_system_faction_army_support
        index = index_y

        set_temp_variable = { index_x = index_y }
        add_to_temp_variable = { index_x = 1 }

        for_loop_effect = {
            start = 0
            end = index_x
            value = i

            add_to_variable = { PRC_faction_struggle_system_faction_army_support_frame^i = PRC_faction_struggle_system_faction_army_support^index_y }
        }
    }
}

PRC_faction_struggle_system_faction_influence_change = {

    custom_effect_tooltip = PRC_faction_struggle_system_faction_influence_change

    if = {
        limit = {
            set_temp_variable = { check = temp_y }
            add_to_temp_variable = { check = PRC_faction_struggle_system_faction_influence^temp_x }
            check_variable = { check < 100 }
            check_variable = { check > 0 }
        }

        set_temp_variable = { temp_t = 100 }
        subtract_from_temp_variable = { temp_t = temp_y }
        subtract_from_temp_variable = { temp_t = PRC_faction_struggle_system_faction_influence^temp_x }
    
        multiply_temp_variable = { temp_y = 100 }
        divide_temp_variable = { temp_y = temp_t }
    
        add_to_variable = { PRC_faction_struggle_system_faction_influence^temp_x = temp_y }
    
        set_temp_variable = { temp_t = 0 }
        for_each_loop = {
            array = PRC_faction_struggle_system_faction_influence
            value = v
    
            add_to_temp_variable = { temp_t = v }
        }
        for_each_loop = {
            array = PRC_faction_struggle_system_faction_influence
            index = i
    
            divide_variable = { PRC_faction_struggle_system_faction_influence^i = temp_t }
            multiply_variable = { PRC_faction_struggle_system_faction_influence^i = 100 }
        }
    }
    else_if = {
        limit = {
            set_temp_variable = { check = temp_y }
            add_to_temp_variable = { check = PRC_faction_struggle_system_faction_influence^temp_x }
            NOT = { check_variable = { check < 100 } }
        }
        for_each_loop = {
            array = PRC_faction_struggle_system_faction_influence
            index = i
    
            set_variable = { PRC_faction_struggle_system_faction_influence^i = 0 }
        }
        set_variable = { PRC_faction_struggle_system_faction_influence^temp_x = 100 }
    }
    else_if = {
        limit = {
            set_temp_variable = { check = temp_y }
            add_to_temp_variable = { check = PRC_faction_struggle_system_faction_influence^temp_x }
            NOT = { check_variable = { check > 0 } }
        }
        set_variable = { PRC_faction_struggle_system_faction_influence^temp_x = 0 }
        set_temp_variable = { temp_t = 0 }
        for_each_loop = {
            array = PRC_faction_struggle_system_faction_influence
            value = v
    
            add_to_temp_variable = { temp_t = v }
        }
        for_each_loop = {
            array = PRC_faction_struggle_system_faction_influence
            index = i
    
            divide_variable = { PRC_faction_struggle_system_faction_influence^i = temp_t }
            multiply_variable = { PRC_faction_struggle_system_faction_influence^i = 100 }
        }
    }

    

    PRC_faction_struggle_system_gui_reflesh = yes
}

PRC_faction_struggle_system_faction_support_change = {

    custom_effect_tooltip = PRC_faction_struggle_system_faction_support_change

    if = {
        limit = {
            check_variable = { temp_z = 0 }
        }
        set_temp_variable = { check = PRC_faction_struggle_system_faction_party_support^temp_x }
        add_to_temp_variable = { check = temp_y }
    }
    else_if = {
        limit = {
            check_variable = { temp_z = 1 }
        }
        set_temp_variable = { check = PRC_faction_struggle_system_faction_gov_support^temp_x }
        add_to_temp_variable = { check = temp_y }
    }
    else_if = {
        limit = {
            check_variable = { temp_z = 2 }
        }
        set_temp_variable = { check = PRC_faction_struggle_system_faction_army_support^temp_x }
        add_to_temp_variable = { check = temp_y }
    }

    if = {
        limit = {
            check_variable = { check < 100 }
            check_variable = { check > 0 }
        }

        set_temp_variable = { temp_t = 100 }
        subtract_from_temp_variable = { temp_t = temp_y }
        if = {
            limit = {
                check_variable = { temp_z = 0 }
            }
            subtract_from_temp_variable = { temp_t = PRC_faction_struggle_system_faction_party_support^temp_x }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 1 }
            }
            subtract_from_temp_variable = { temp_t = PRC_faction_struggle_system_faction_gov_support^temp_x }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 2 }
            }
            subtract_from_temp_variable = { temp_t = PRC_faction_struggle_system_faction_army_support^temp_x }
        }
    
        multiply_temp_variable = { temp_y = 100 }
        divide_temp_variable = { temp_y = temp_t }
    
        if = {
            limit = {
                check_variable = { temp_z = 0 }
            }
            add_to_variable = { PRC_faction_struggle_system_faction_party_support^temp_x = temp_y }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 1 }
            }
            add_to_variable = { PRC_faction_struggle_system_faction_gov_support^temp_x = temp_y }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 2 }
            }
            add_to_variable = { PRC_faction_struggle_system_faction_army_support^temp_x = temp_y }
        }
    
        set_temp_variable = { temp_t = 0 }
    
        if = {
            limit = {
                check_variable = { temp_z = 0 }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_party_support
                value = v
        
                add_to_temp_variable = { temp_t = v }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_party_support
                index = i
        
                divide_variable = { PRC_faction_struggle_system_faction_party_support^i = temp_t }
                multiply_variable = { PRC_faction_struggle_system_faction_party_support^i = 100 }
            }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 1 }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_gov_support
                value = v
        
                add_to_temp_variable = { temp_t = v }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_gov_support
                index = i
        
                divide_variable = { PRC_faction_struggle_system_faction_gov_support^i = temp_t }
                multiply_variable = { PRC_faction_struggle_system_faction_gov_support^i = 100 }
            }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 2 }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_army_support
                value = v
        
                add_to_temp_variable = { temp_t = v }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_army_support
                index = i
        
                divide_variable = { PRC_faction_struggle_system_faction_army_support^i = temp_t }
                multiply_variable = { PRC_faction_struggle_system_faction_army_support^i = 100 }
            }
        }
    }
    else_if = {
        limit = {
            NOT = { check_variable = { check < 100 } }
        }

        if = {
            limit = {
                check_variable = { temp_z = 0 }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_party_support
                index = i
        
                set_variable = { PRC_faction_struggle_system_faction_party_support^i = 0 }
            }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 1 }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_gov_support
                index = i
        
                set_variable = { PRC_faction_struggle_system_faction_gov_support^i = 0 }
            }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 2 }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_army_support
                index = i
        
                set_variable = { PRC_faction_struggle_system_faction_army_support^i = 0 }
            }
        }

        if = {
            limit = {
                check_variable = { temp_z = 0 }
            }
            set_variable = { PRC_faction_struggle_system_faction_party_support^temp_x = 100 }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 1 }
            }
            set_variable = { PRC_faction_struggle_system_faction_gov_support^temp_x = 100 }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 2 }
            }
            set_variable = { PRC_faction_struggle_system_faction_army_support^temp_x = 100 }
        }
    }
    else_if = {
        limit = {
            NOT = { check_variable = { check > 0 } }
        }

        if = {
            limit = {
                check_variable = { temp_z = 0 }
            }
            set_variable = { PRC_faction_struggle_system_faction_party_support^temp_x = 0 }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 1 }
            }
            set_variable = { PRC_faction_struggle_system_faction_gov_support^temp_x = 0 }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 2 }
            }
            set_variable = { PRC_faction_struggle_system_faction_army_support^temp_x = 0 }
        }
    
        set_temp_variable = { temp_t = 0 }
    
        if = {
            limit = {
                check_variable = { temp_z = 0 }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_party_support
                value = v
        
                add_to_temp_variable = { temp_t = v }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_party_support
                index = i
        
                divide_variable = { PRC_faction_struggle_system_faction_party_support^i = temp_t }
                multiply_variable = { PRC_faction_struggle_system_faction_party_support^i = 100 }
            }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 1 }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_gov_support
                value = v
        
                add_to_temp_variable = { temp_t = v }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_gov_support
                index = i
        
                divide_variable = { PRC_faction_struggle_system_faction_gov_support^i = temp_t }
                multiply_variable = { PRC_faction_struggle_system_faction_gov_support^i = 100 }
            }
        }
        else_if = {
            limit = {
                check_variable = { temp_z = 2 }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_army_support
                value = v
        
                add_to_temp_variable = { temp_t = v }
            }
            for_each_loop = {
                array = PRC_faction_struggle_system_faction_army_support
                index = i
        
                divide_variable = { PRC_faction_struggle_system_faction_army_support^i = temp_t }
                multiply_variable = { PRC_faction_struggle_system_faction_army_support^i = 100 }
            }
        }
    }

    PRC_faction_struggle_system_gui_reflesh = yes
}

PRC_faction_struggle_system_faction_var_change = {
    if = {
        limit = {
            check_variable = { temp_x = 0 }
        }
        add_to_variable = { PRC_faction_struggle_system_party_united = temp_y }
    }
    else_if = {
        limit = {
            check_variable = { temp_x = 1 }
        }
        add_to_variable = { PRC_faction_struggle_system_party_discipline = temp_y }
    }

    clamp_variable = {
		var = PRC_faction_struggle_system_party_united
		min = 0
		max = 100
	}
    clamp_variable = {
		var = PRC_faction_struggle_system_party_discipline
		min = 0
		max = 100
	}
    
    custom_effect_tooltip = PRC_faction_struggle_system_faction_var_change
}

PRC_faction_struggle_system_faction_supporter_change = {
    if = {
        limit = {
            check_variable = { temp_y = 0 }
        }
        if = {
            limit = {
                meta_trigger = {
                    text = {
                        is_in_array = {
                            PRC_faction_struggle_system_faction_supporter_[x] = temp_i
                        }
                    }
                    x = "[?temp_x]"
                }
            }
            meta_effect = {
                text = {
                    remove_from_array = {
                        array = PRC_faction_struggle_system_faction_supporter_[x]
	                    value = temp_i
                    }
                }
                x = "[?temp_x]"
            }
        }
        custom_effect_tooltip = PRC_faction_struggle_system_faction_supporter_remove
    }
    else_if = {
        limit = {
            check_variable = { temp_y = 1 }
        }
        if = {
            limit = {
                NOT = {
                    meta_trigger = {
                        text = {
                            is_in_array = {
                                PRC_faction_struggle_system_faction_supporter_[x] = temp_i
                            }
                        }
                        x = "[?temp_x]"
                    }
                }
            }
            meta_effect = {
                text = {
                    add_to_array = {
                        array = PRC_faction_struggle_system_faction_supporter_[x]
	                    value = temp_i
                    }
                }
                x = "[?temp_x]"
            }
            custom_effect_tooltip = PRC_faction_struggle_system_faction_supporter_add
        }
    }

    PRC_faction_struggle_system_faction_supporter_effect_reflesh = yes
}

PRC_faction_struggle_system_faction_supporter_effect_reflesh = {
    clear_array = PRC_faction_struggle_system_faction_supporter_feffect

    for_loop_effect = {
        start = 0 
        end = 5
        value = v

        add_to_array = { PRC_faction_struggle_system_faction_supporter_feffect = 0 }

        meta_effect = {
            text = {
                for_each_loop = {
                    array = PRC_faction_struggle_system_faction_supporter_[x]
                    value = index

                    add_to_variable = { PRC_faction_struggle_system_faction_supporter_feffect^v = PRC_faction_struggle_system_faction_supporter_effect^index }
                }
            }
            x = "[?v]"
        }
    }
}

PRC_faction_struggle_system_faction_supporter_effect_change = {
    add_to_variable = { PRC_faction_struggle_system_faction_supporter_effect^temp_i = temp_y }

    custom_effect_tooltip = PRC_faction_struggle_system_faction_supporter_effect_change
    PRC_faction_struggle_system_faction_supporter_effect_reflesh = yes
}


##社会阶级                    #态度(-50，50)      #权重(0，100)
# 0 - Senior Cadre              
# 1 - Lower Cadre
# 2 - Military Officer
# 3 - Soldier
# 4 - Landlord Rich Peasant
# 5 - Middle Peasant
# 6 - Poor Peasant
# 7 - Comprador Bourgeoisie
# 8 - National Bourgeoisie
# 9 - Petty Bourgeoisie
# 10 - Intellectual
# 11 - Senior Worker
# 12 - Middle Lower Worker
# 13 - Priest
# 14 - Red Nobility
# 15 - Entrepreneur
PRC_Social_Class_startup = {
	clear_array = PRC_class_array
	clear_array = PRC_class_weight_array
	clear_array = PRC_class_opinion_array

	add_to_array = { PRC_class_array = 0 }
	add_to_array = { PRC_class_weight_array = 100 }
	add_to_array = { PRC_class_opinion_array = 45 }
	add_to_array = { PRC_class_array = 1 }
	add_to_array = { PRC_class_weight_array = 75 }
	add_to_array = { PRC_class_opinion_array = 15 }
	add_to_array = { PRC_class_array = 2 }
	add_to_array = { PRC_class_weight_array = 90 }
	add_to_array = { PRC_class_opinion_array = 40 }
	add_to_array = { PRC_class_array = 3 }
	add_to_array = { PRC_class_weight_array = 50 }
	add_to_array = { PRC_class_opinion_array = 30 }
	add_to_array = { PRC_class_array = 4 }
	add_to_array = { PRC_class_weight_array = 50 }
	add_to_array = { PRC_class_opinion_array = -10 }
	add_to_array = { PRC_class_array = 5 }
	add_to_array = { PRC_class_weight_array = 15 }
	add_to_array = { PRC_class_opinion_array = 10 }
	add_to_array = { PRC_class_array = 6 }
	add_to_array = { PRC_class_weight_array = 5 }
	add_to_array = { PRC_class_opinion_array = 40 }
	add_to_array = { PRC_class_array = 7 }
	add_to_array = { PRC_class_weight_array = 50 }
	add_to_array = { PRC_class_opinion_array = -50 }
	add_to_array = { PRC_class_array = 8 }
	add_to_array = { PRC_class_weight_array = 25 }
	add_to_array = { PRC_class_opinion_array = 25 }
	add_to_array = { PRC_class_array = 9 }
	add_to_array = { PRC_class_weight_array = 5 }
	add_to_array = { PRC_class_opinion_array = 15 }
	add_to_array = { PRC_class_array = 10 }
	add_to_array = { PRC_class_weight_array = 75 }
	add_to_array = { PRC_class_opinion_array = 20 }
	add_to_array = { PRC_class_array = 11 }
	add_to_array = { PRC_class_weight_array = 5 }
	add_to_array = { PRC_class_opinion_array = 35 }
	add_to_array = { PRC_class_array = 12 }
	add_to_array = { PRC_class_weight_array = 5 }
	add_to_array = { PRC_class_opinion_array = 50 }
	add_to_array = { PRC_class_array = 13 }
	add_to_array = { PRC_class_weight_array = 50 }
	add_to_array = { PRC_class_opinion_array = -10 }

    set_variable = { PRC_major_class_page = 1 }
    set_variable = { PRC_general_class_page = 1 }
    set_variable = { PRC_marginal_class_page = 1 }

    PRC_class_status_change = yes
}
PRC_class_modifier_update = {
    set_variable = { PRC_class_global_building_slots_factor = 0 }
	set_variable = { PRC_class_conscription_factor = 0 }
	set_variable = { PRC_class_political_power_factor = 0 }
    set_variable = { PRC_class_maoism_drift = 0 }
    set_variable = { PRC_class_trotskyism_drift = 0 }
    set_variable = { PRC_class_communism_drift = 0 }
    set_variable = { PRC_class_socialist_drift = 0 }
	set_variable = { PRC_class_stability_factor = 0 }
	set_variable = { PRC_class_monthly_population = 0 }
	set_variable = { PRC_class_conscription = 0 }
	set_variable = { PRC_class_drift_defence_factor = 0 }
	set_variable = { PRC_class_production_speed_buildings_factor = 0 }
	set_variable = { PRC_class_min_export = 0 }
	set_variable = { PRC_class_supply_node_range = 0 }
	set_variable = { PRC_class_production_speed_rail_way_factor = 0 }
	set_variable = { PRC_class_production_speed_infrastructure_factor = 0 }
	set_variable = { PRC_class_local_resources_factor = 0 }
	set_variable = { PRC_class_trade_opinion_factor = 0 }
	set_variable = { PRC_class_consumer_goods_factor = 0 }
	set_variable = { PRC_class_production_factory_efficiency_gain_factor = 0 }
	set_variable = { PRC_class_line_change_production_efficiency_factor = 0 }
	set_variable = { PRC_class_industrial_capacity_factory = 0 }
	set_variable = { PRC_class_political_power_gain = 0 }
    set_variable = { PRC_class_political_power_cost = 0 }
	set_variable = { PRC_class_production_factory_start_efficiency_factor = 0 }
    set_variable = { PRC_class_country_resource_rubber = 0 }
	set_variable = { PRC_class_office_park_income_adjustment = 0 }
	set_variable = { PRC_class_research_speed_factor = 0 }
	set_variable = { PRC_class_land_reinforce_rate = 0 }
	set_variable = { PRC_class_army_org_regain = 0 }
	set_variable = { PRC_class_foreign_subversive_activites = 0 }
	set_variable = { PRC_class_war_support_factor = 0 }
	set_variable = { PRC_class_industry_free_repair_factor = 0 }
	set_variable = { PRC_class_initiative_factor = 0 }
	set_variable = { PRC_class_attrition = 0 }
	set_variable = { PRC_class_mobilization_speed = 0 }
	set_variable = { PRC_class_special_forces_cap = 0 }
	set_variable = { PRC_class_experience_loss_factor = 0 }
	set_variable = { PRC_class_military_leader_cost_factor = 0 }
	set_variable = { PRC_class_experience_gain_army_unit_factor = 0 }
	set_variable = { PRC_class_army_org_factor = 0 }
	set_variable = { PRC_class_org_loss_when_moving = 0 }
	set_variable = { PRC_class_army_attack_factor = 0 }
	set_variable = { PRC_class_army_defence_factor = 0 }
	set_variable = { PRC_class_production_factory_max_efficiency_factor = 0 }
	set_variable = { PRC_class_industry_repair_factor = 0 }

    for_each_loop = {
        array = PRC_class_array
        #index = i
		value = v
        
        if = {
            limit = {
                check_variable = { 
                    var = PRC_class_weight_array^v
                    value = 25 
                    compare = less_than 
                }
            }
            set_temp_variable = { PRC_temp_multiple_1 = 0.6 }
        }
        else_if = {
            limit = {
                check_variable = { 
                    var = PRC_class_weight_array^v
                    value = 25 
                    compare = greater_than_or_equals 
                }
                check_variable = { 
                    var = PRC_class_weight_array^v
                    value = 70 
                    compare = less_than 
                }
            }
            set_temp_variable = { PRC_temp_multiple_1 = 1.2 }
        }
        else_if = {
            limit = {
                check_variable = { 
                    var = PRC_class_weight_array^v
                    value = 70 
                    compare = greater_than_or_equals 
                }
            }
            set_temp_variable = { PRC_temp_multiple_1 = 2 }
        }

        set_temp_variable = { PRC_temp_multiple_2 = PRC_class_weight_array^v }
        divide_temp_variable = { PRC_temp_multiple_2 = 100 }

        set_temp_variable = { PRC_temp_multiple_3 = PRC_class_opinion_array^v }
        divide_temp_variable = { PRC_temp_multiple_3 = 50 }

        set_temp_variable = { PRC_temp_multiple = PRC_temp_multiple_1 }
        multiply_temp_variable = { PRC_temp_multiple = PRC_temp_multiple_2 }
        multiply_temp_variable = { PRC_temp_multiple = PRC_temp_multiple_3 }
         
        if = {
            limit = { check_variable = { v = 0 } }
            set_variable = { PRC_Senior_Cadre_political_power_factor = 0.05 }
            multiply_variable = { PRC_Senior_Cadre_political_power_factor = PRC_temp_multiple }
            set_variable = { PRC_Senior_Cadre_drift_defence_factor = 0.15 }
            multiply_variable = { PRC_Senior_Cadre_drift_defence_factor = PRC_temp_multiple }
            set_variable = { PRC_Senior_Cadre_ideology_drift = 0.01 }
            multiply_variable = { PRC_Senior_Cadre_ideology_drift = PRC_temp_multiple }

            add_to_variable = { PRC_class_political_power_factor = PRC_Senior_Cadre_political_power_factor }
            add_to_variable = { PRC_class_drift_defence_factor = PRC_Senior_Cadre_drift_defence_factor }
            if = {
                limit = { has_government = maoism }
                add_to_variable = { PRC_class_maoism_drift = PRC_Senior_Cadre_ideology_drift }
            }
            else_if = {
                limit = { has_government = communism }
                add_to_variable = { PRC_class_communism_drift = PRC_Senior_Cadre_ideology_drift }
            }
            else_if = {
                limit = { has_government = trotskyism }
                add_to_variable = { PRC_class_trotskyism_drift = PRC_Senior_Cadre_ideology_drift }
            }
            else_if = {
                limit = { has_government = socialist }
                add_to_variable = { PRC_class_socialist_drift = PRC_Senior_Cadre_ideology_drift }
            }
        }
        else_if = {
            limit = { check_variable = { v = 1 } }
            #set_variable = { PRC_Lower_Cadre_mobilization_speed = 0.05 }
            #multiply_variable = { PRC_Lower_Cadre_mobilization_speed = PRC_temp_multiple }
            set_variable = { PRC_Lower_Cadre_production_speed_buildings_factor = 0.1 }
            multiply_variable = { PRC_Lower_Cadre_production_speed_buildings_factor = PRC_temp_multiple }
            set_variable = { PRC_Lower_Cadre_stability_factor = 0.05 }
            multiply_variable = { PRC_Lower_Cadre_stability_factor = PRC_temp_multiple }
            
            #add_to_variable = { PRC_class_mobilization_speed = PRC_Lower_Cadre_mobilization_speed }
            add_to_variable = { PRC_class_stability_factor = PRC_Lower_Cadre_stability_factor }
            add_to_variable = { PRC_class_production_speed_buildings_factor = PRC_Lower_Cadre_production_speed_buildings_factor }
        }
        else_if = {
            limit = { check_variable = { v = 2 } }
            set_variable = { PRC_Military_Officer_mobilization_speed = 0.1 }
            multiply_variable = { PRC_Military_Officer_mobilization_speed = PRC_temp_multiple }
            set_variable = { PRC_Military_Officer_army_org_factor = 0.06 }
            multiply_variable = { PRC_Military_Officer_army_org_factor = PRC_temp_multiple }
            #set_variable = { PRC_Military_Officer_military_leader_cost_factor = -0.2 }
            #multiply_variable = { PRC_Military_Officer_military_leader_cost_factor = PRC_temp_multiple }
            set_variable = { PRC_Military_Officer_experience_gain_army_unit_factor = 0.1 }
            multiply_variable = { PRC_Military_Officer_experience_gain_army_unit_factor = PRC_temp_multiple }
            set_variable = { PRC_Military_Officer_einitiative_factor = 0.1 }
            multiply_variable = { PRC_Military_Officer_einitiative_factor = PRC_temp_multiple }
            
            add_to_variable = { PRC_class_mobilization_speed = PRC_Military_Officer_mobilization_speed }
            add_to_variable = { PRC_class_army_org_factor = PRC_Military_Officer_army_org_factor }
            add_to_variable = { PRC_class_experience_gain_army_unit_factor = PRC_Military_Officer_experience_gain_army_unit_factor }
            add_to_variable = { PRC_class_Officer_einitiative_factor = PRC_Military_Officer_einitiative_factor }
        }
        else_if = {
            limit = { check_variable = { v = 3 } }
            set_variable = { PRC_Soldier_army_org_regain = 0.1 }
            multiply_variable = { PRC_Soldier_army_org_regain = PRC_temp_multiple }
            set_variable = { PRC_Soldier_experience_loss_factor = -0.1 }
            multiply_variable = { PRC_Soldier_experience_loss_factor = PRC_temp_multiple }
            set_variable = { PRC_Soldier_army_attack_factor = 0.05 }
            multiply_variable = { PRC_Soldier_army_attack_factor = PRC_temp_multiple }
            set_variable = { PRC_Soldier_army_defence_factor = 0.05 }
            multiply_variable = { PRC_Soldier_army_defence_factor = PRC_temp_multiple }
            set_variable = { PRC_Soldier_attrition = -0.1 }
            multiply_variable = { PRC_Soldier_attrition = PRC_temp_multiple }
            
            add_to_variable = { PRC_class_army_org_regain = PRC_Soldier_army_org_regain }
            add_to_variable = { PRC_class_experience_loss_factor = PRC_Soldier_experience_loss_factor }
            add_to_variable = { PRC_class_army_attack_factor = PRC_Soldier_army_attack_factor }
            add_to_variable = { PRC_class_army_defence_factor = PRC_Soldier_army_defence_factor }
            add_to_variable = { PRC_class_army_attrition = PRC_Soldier_attrition }
        }
        else_if = {
            limit = { check_variable = { v = 4 } }
            set_variable = { PRC_Landlord_Rich_Peasant_global_building_slots_factor = -0.1 }
            multiply_variable = { PRC_Landlord_Rich_Peasant_global_building_slots_factor = PRC_temp_multiple }
            divide_variable = { PRC_Landlord_Rich_Peasant_global_building_slots_factor = PRC_temp_multiple_3 }
            set_variable = { PRC_Landlord_Rich_Peasant_local_resources_factor = -0.08 }
            multiply_variable = { PRC_Landlord_Rich_Peasant_local_resources_factor = PRC_temp_multiple }
            divide_variable = { PRC_Landlord_Rich_Peasant_local_resources_factor = PRC_temp_multiple_3 }
            set_variable = { PRC_Landlord_Rich_Peasant_monthly_population = 0.05 }
            multiply_variable = { PRC_Landlord_Rich_Peasant_monthly_population = PRC_temp_multiple }
            divide_variable = { PRC_Landlord_Rich_Peasant_monthly_population = PRC_temp_multiple_3 }
            set_variable = { PRC_Landlord_Rich_stability_factor = 0.05 }
            multiply_variable = { PRC_Landlord_Rich_stability_factor = PRC_temp_multiple }
           
            add_to_variable = { PRC_class_global_building_slots_factor = PRC_Landlord_Rich_Peasant_global_building_slots_factor }
            add_to_variable = { PRC_class_local_resources_factor = PRC_Landlord_Rich_Peasant_local_resources_factor }
            add_to_variable = { PRC_class_monthly_population = PRC_Landlord_Rich_Peasant_monthly_population }
            add_to_variable = { PRC_class_stability_factor = PRC_Landlord_Rich_stability_factor }
        }
        else_if = {
            limit = { check_variable = { v = 5 } }
            set_variable = { PRC_Middle_Peasant_min_export = -0.1 }
            multiply_variable = { PRC_Middle_Peasant_min_export = PRC_temp_multiple }
            set_variable = { PRC_Middle_Peasant_production_factory_efficiency_gain_factor = 0.6 }
            multiply_variable = { PRC_Middle_Peasant_production_factory_efficiency_gain_factor = PRC_temp_multiple }
            set_variable = { PRC_Middle_Peasant_country_resource_rubber = 10 }
            multiply_variable = { PRC_Middle_Peasant_country_resource_rubber = PRC_temp_multiple }
           
            add_to_variable = { PRC_class_min_export = PRC_Middle_Peasant_min_export }
            add_to_variable = { PRC_class_production_factory_efficiency_gain_factor = PRC_Middle_Peasant_production_factory_efficiency_gain_factor }
            add_to_variable = { PRC_class_country_resource_rubber = PRC_Middle_Peasant_country_resource_rubber }
        }
        else_if = {
            limit = { check_variable = { v = 6 } }
            set_variable = { PRC_Poor_Peasant_industry_free_repair_factor = 0.25 }
            multiply_variable = { PRC_Poor_Peasant_industry_free_repair_factor = PRC_temp_multiple }
            set_variable = { PRC_Poor_Peasant_war_support_factor = 0.05 }
            multiply_variable = { PRC_Poor_Peasant_war_support_factor = PRC_temp_multiple }
            set_variable = { PRC_Poor_Peasant_monthly_population = 0.12 }
            multiply_variable = { PRC_Poor_Peasant_monthly_population = PRC_temp_multiple }
           
            add_to_variable = { PRC_class_industry_free_repair_factor = PRC_Poor_Peasant_industry_free_repair_factor }
            add_to_variable = { PRC_class_war_support_factor = PRC_Poor_Peasant_war_support_factor }
            add_to_variable = { PRC_class_monthly_population = PRC_Poor_Peasant_monthly_population }
        }
        else_if = {
            limit = { check_variable = { v = 7 } }
            set_variable = { PRC_Comprador_Bourgeoisie_consumer_goods_factor = -0.1 }
            multiply_variable = { PRC_Comprador_Bourgeoisie_consumer_goods_factor = PRC_temp_multiple }
            set_variable = { PRC_Comprador_Bourgeoisie_class_min_export = 0.2 }
            multiply_variable = { PRC_Comprador_Bourgeoisie_class_min_export = PRC_temp_multiple }
            divide_variable = { PRC_Comprador_Bourgeoisie_class_min_export = PRC_temp_multiple_3 }
            set_variable = { PRC_Comprador_Bourgeoisie_political_power_cost = 0.15 }
            multiply_variable = { PRC_Comprador_Bourgeoisie_political_power_cost = PRC_temp_multiple }
            divide_variable = { PRC_Comprador_Bourgeoisie_political_power_cost = PRC_temp_multiple_3 }
            set_variable = { PRC_Comprador_Bourgeoisie_trade_opinion_factor = 0.12 }
            multiply_variable = { PRC_Comprador_Bourgeoisie_trade_opinion_factor = PRC_temp_multiple }
            set_variable = { PRC_Comprador_Bourgeoisie_production_speed_rail_way_factor = 0.2 }
            multiply_variable = { PRC_Comprador_Bourgeoisie_production_speed_rail_way_factor = PRC_temp_multiple }
            set_variable = { PRC_Comprador_Bourgeoisie_production_speed_infrastructure_factor = 0.2 }
            multiply_variable = { PRC_Comprador_Bourgeoisie_production_speed_infrastructure_factor = PRC_temp_multiple }
            set_variable = { PRC_Comprador_Bourgeoisie_supply_node_range = 0.1 }
            multiply_variable = { PRC_Comprador_Bourgeoisie_supply_node_range = PRC_temp_multiple }
           
            #clamp_variable = {
            #    var = PRC_Comprador_Bourgeoisie_consumer_goods_factor
            #    min = -0.1
            #    max = 0
            #}
            
            add_to_variable = { PRC_class_consumer_goods_factor = PRC_Comprador_Bourgeoisie_consumer_goods_factor }
            add_to_variable = { PRC_class_min_export = PRC_Comprador_Bourgeoisie_class_min_export }
            add_to_variable = { PRC_class_political_power_cost = PRC_Comprador_Bourgeoisie_political_power_cost }
            add_to_variable = { PRC_class_trade_opinion_factor = PRC_Comprador_Bourgeoisie_trade_opinion_factor }
            add_to_variable = { PRC_class_production_speed_rail_way_factor = PRC_Comprador_Bourgeoisie_production_speed_rail_way_factor }
            add_to_variable = { PRC_class_production_speed_infrastructure_factor = PRC_Comprador_Bourgeoisie_production_speed_infrastructure_factor }
            add_to_variable = { PRC_class_supply_node_range = PRC_Comprador_Bourgeoisie_supply_node_range }
        }
        else_if = {
            limit = { check_variable = { v = 8 } }
            set_variable = { PRC_National_Bourgeoisie_consumer_goods_factor = 0.05 }
            multiply_variable = { PRC_National_Bourgeoisie_consumer_goods_factor = PRC_temp_multiple }
            #set_variable = { PRC_National_Bourgeoisie_research_speed_factor = 0.03 }
            #multiply_variable = { PRC_National_Bourgeoisie_research_speed_factor = PRC_temp_multiple }
            set_variable = { PRC_National_Bourgeoisie_production_speed_buildings_factor = 0.05 }
            multiply_variable = { PRC_National_Bourgeoisie_production_speed_buildings_factor = PRC_temp_multiple }
            set_variable = { PRC_National_Bourgeoisie_line_change_production_efficiency_factor = 0.08 }
            multiply_variable = { PRC_National_Bourgeoisie_line_change_production_efficiency_factor = PRC_temp_multiple }
            #set_variable = { PRC_National_Bourgeoisie_office_park_income_adjustment = 0.1 }
            #multiply_variable = { PRC_National_Bourgeoisie_office_park_income_adjustment = PRC_temp_multiple }
            set_variable = { PRC_National_Bourgeoisie_production_factory_efficiency_gain_factor = 0.08 }
            multiply_variable = { PRC_National_Bourgeoisie_production_factory_efficiency_gain_factor = PRC_temp_multiple }
            
            clamp_variable = {
                var = PRC_National_Bourgeoisie_consumer_goods_factor
                max = 0.05
                min = 0
            }
    
            add_to_variable = { PRC_class_consumer_goods_factor = PRC_National_Bourgeoisie_consumer_goods_factor }
            #add_to_variable = { PRC_class_research_speed_factor = PRC_National_Bourgeoisie_research_speed_factor }
            add_to_variable = { PRC_class_production_speed_buildings_factor = PRC_National_Bourgeoisie_production_speed_buildings_factor }
            add_to_variable = { PRC_class_line_change_production_efficiency_factor = PRC_National_Bourgeoisie_line_change_production_efficiency_factor }
            #add_to_variable = { PRC_class_office_park_income_adjustment = PRC_National_Bourgeoisie_office_park_income_adjustment }
            add_to_variable = { PRC_class_production_factory_efficiency_gain_factor = PRC_National_Bourgeoisie_production_factory_efficiency_gain_factor }
        }
        else_if = {
            limit = { check_variable = { v = 9 } }
            set_variable = { PRC_Petty_Bourgeoisie_office_park_income_adjustment = 0.1 }
            multiply_variable = { PRC_Petty_Bourgeoisie_office_park_income_adjustment = PRC_temp_multiple }
            set_variable = { PRC_Petty_Bourgeoisie_research_speed_factor = 0.02 }
            multiply_variable = { PRC_Petty_Bourgeoisie_research_speed_factor = PRC_temp_multiple }
            set_variable = { PRC_Petty_Bourgeoisie_production_factory_start_efficiency_factor = 0.06 }
            multiply_variable = { PRC_Petty_Bourgeoisie_production_factory_start_efficiency_factor = PRC_temp_multiple }
            set_variable = { PRC_Petty_Bourgeoisie_stability_factor = 0.05 }
            multiply_variable = { PRC_Petty_Bourgeoisie_stability_factor = PRC_temp_multiple }
    
            add_to_variable = { PRC_class_consumer_goods_factor = PRC_National_Bourgeoisie_consumer_goods_factor }
            add_to_variable = { PRC_class_production_speed_buildings_factor = PRC_National_Bourgeoisie_production_speed_buildings_factor }
            add_to_variable = { PRC_class_line_change_production_efficiency_factor = PRC_National_Bourgeoisie_line_change_production_efficiency_factor }
            add_to_variable = { PRC_class_office_park_income_adjustment = PRC_National_Bourgeoisie_office_park_income_adjustment }
            add_to_variable = { PRC_class_production_factory_efficiency_gain_factor = PRC_National_Bourgeoisie_production_factory_efficiency_gain_factor }
            add_to_variable = { PRC_class_stability_factor = PRC_Petty_Bourgeoisie_stability_factor }
        }
        else_if = {
            limit = { check_variable = { v = 10 } }
            set_variable = { PRC_Intellectual_political_power_factor = -0.1 }
            multiply_variable = { PRC_Intellectual_political_power_factor = PRC_temp_multiple }
            divide_variable = { PRC_Intellectual_political_power_factor = PRC_temp_multiple_3 }
            set_variable = { PRC_Intellectual_research_speed_factor = 0.08 }
            multiply_variable = { PRC_Intellectual_research_speed_factor = PRC_temp_multiple }
            set_variable = { PRC_Intellectual_foreign_subversive_activites = -0.15 }
            multiply_variable = { PRC_Intellectual_foreign_subversive_activites = PRC_temp_multiple }
            set_variable = { PRC_Intellectual_stability_factor = 0.1 }
            multiply_variable = { PRC_Intellectual_stability_factor = PRC_temp_multiple }
             
            #clamp_variable = {
            #    var = PRC_Intellectual_political_power_factor
            #    max = 0
            #    min = -0.1
            #}
            clamp_variable = {
                var = PRC_Intellectual_research_speed_factor
                max = 0.08
                min = -0.05
            }
            clamp_variable = {
                var = PRC_Intellectual_stability_factor
                max = 0
                min = -0.1
            }
            add_to_variable = { PRC_class_political_power_factor = PRC_Intellectual_political_power_factor }
            add_to_variable = { PRC_class_research_speed_factor = PRC_Intellectual_research_speed_factor }
            add_to_variable = { PRC_class_foreign_subversive_activites = PRC_Intellectual_foreign_subversive_activites }
            add_to_variable = { PRC_class_stability_factor = PRC_Intellectual_stability_factor }
        }
        else_if = {
            limit = { check_variable = { v = 11 } }
            set_variable = { PRC_Senior_Worker_research_speed_factor = 0.05 }
            multiply_variable = { PRC_Senior_Worker_research_speed_factor = PRC_temp_multiple }
            set_variable = { PRC_Senior_Worker_production_factory_max_efficiency_factor = 0.1 }
            multiply_variable = { PRC_Senior_Worker_production_factory_max_efficiency_factor = PRC_temp_multiple }
            set_variable = { PRC_Senior_Worker_line_change_production_efficiency_factor = 0.1 }
            multiply_variable = { PRC_Senior_Worker_line_change_production_efficiency_factor = PRC_temp_multiple }

            add_to_variable = { PRC_class_research_speed_factor = PRC_Senior_Worker_research_speed_factor }
            add_to_variable = { PRC_class_production_factory_max_efficiency_factor = PRC_Senior_Worker_production_factory_max_efficiency_factor }
            add_to_variable = { PRC_class_line_change_production_efficiency_factor = PRC_Senior_Worker_line_change_production_efficiency_factor }
        }

        else_if = {
            limit = { check_variable = { v = 12 } }
            set_variable = { PRC_Middle_Lower_Worker_industry_repair_factor = 0.15 }
            multiply_variable = { PRC_Middle_Lower_Worker_industry_repair_factor = PRC_temp_multiple }
            set_variable = { PRC_Middle_Lower_Worker_industrial_capacity_factory = 0.08 }
            multiply_variable = { PRC_Middle_Lower_Worker_industrial_capacity_factory = PRC_temp_multiple }
            set_variable = { PRC_Middle_Lower_Worker_production_speed_buildings_factor = 0.05 }
            multiply_variable = { PRC_Middle_Lower_Worker_production_speed_buildings_factor = PRC_temp_multiple }
            set_variable = { PRC_Middle_Lower_Worker_production_factory_efficiency_gain_factor = 0.05 }
            multiply_variable = { PRC_Middle_Lower_Worker_production_factory_efficiency_gain_factor = PRC_temp_multiple }

            add_to_variable = { PRC_class_industry_repair_factor = PRC_Middle_Lower_Worker_industry_repair_factor }
            add_to_variable = { PRC_class_industrial_capacity_factory = PRC_Middle_Lower_Worker_industrial_capacity_factory }
            add_to_variable = { PRC_class_production_speed_buildings_factor = PRC_Middle_Lower_Worker_production_speed_buildings_factor }
            add_to_variable = { PRC_class_production_factory_efficiency_gain_factor = PRC_Middle_Lower_Worker_production_factory_efficiency_gain_factor }
        }
    }

    force_update_dynamic_modifier = yes
}
PRC_class_status_change = {
    set_temp_variable = { temp_v = temp_class }
    
    if = {
        limit = { has_variable = temp_weight }
        add_to_variable = { PRC_class_weight_array^temp_class = temp_weight }
        clamp_variable = {
            var = PRC_class_weight_array^temp_class
            min = 0
            max = 100
        }
        custom_effect_tooltip = PRC_class_weight_change_tt
    }
    if = {
        limit = { has_variable = temp_opinion }
        add_to_variable = { PRC_class_opinion_array^temp_class = temp_opinion }
        clamp_variable = {
            var = PRC_class_opinion_array^temp_class
            min = -50
            max = 50
        }
        custom_effect_tooltip = PRC_class_opinion_change_tt
    }
    

    if = {
        limit = {
            is_in_array = { PRC_major_class_array = temp_class }
        }
        set_temp_variable = { PRC_previous_major_class = temp_class }
    }
    else_if = {
        limit = {
            is_in_array = { PRC_general_class_array = temp_class }
        }
        set_temp_variable = { PRC_previous_general_class = temp_class }
    }
    else_if = {
        limit = {
            is_in_array = { PRC_marginal_class_array = temp_class }
        }
        set_temp_variable = { PRC_previous_marginal_class = temp_class }
    }
    
    clear_array = PRC_major_class_array
    clear_array = PRC_general_class_array
    clear_array = PRC_marginal_class_array
    for_each_loop = {
        array = PRC_class_array
        #index = i
		value = v

        if = {
            limit = {
                check_variable = { 
                    var = PRC_class_weight_array^v
                    value = 25 
                    compare = less_than 
                }
            }
            add_to_array = { PRC_marginal_class_array = v }
            if = {
                limit = { 
                    check_variable = { v = temp_class }
                    NOT = { has_variable = PRC_previous_marginal_class }
                }
                set_temp_variable = { PRC_temp_marginal_class = temp_class }
            }
        }
        else_if = {
            limit = {
                check_variable = { 
                    var = PRC_class_weight_array^v
                    value = 25 
                    compare = greater_than_or_equals 
                }
                check_variable = { 
                    var = PRC_class_weight_array^v
                    value = 70 
                    compare = less_than 
                }
            }
            add_to_array = { PRC_general_class_array = v }
            if = {
                limit = { 
                    check_variable = { v = temp_class }
                    NOT = { has_variable = PRC_previous_general_class }
                }
                set_temp_variable = { PRC_temp_general_class = temp_class }
            }
        }
        else_if = {
            limit = {
                check_variable = { 
                    var = PRC_class_weight_array^v
                    value = 70 
                    compare = greater_than_or_equals 
                }
            }
            add_to_array = { PRC_major_class_array = v }
            if = {
                limit = { 
                    check_variable = { v = temp_class }
                    NOT = { has_variable = PRC_previous_major_class }
                }
                set_temp_variable = { PRC_temp_major_class = temp_class }
            }
        }
    }

    if = {
        limit = { 
            OR = {
                has_variable = PRC_previous_major_class
                has_variable = PRC_previous_general_class
                has_variable = PRC_previous_marginal_class
            }
            OR = {
                has_variable = PRC_temp_major_class
                has_variable = PRC_temp_general_class
                has_variable = PRC_temp_marginal_class
            }
        }
        custom_effect_tooltip = PRC_class_status_change_tt
    }

    PRC_class_modifier_update = yes

    clear_variable = temp_weight
    clear_variable = temp_opinion
}
PRC_class_removal = {
    set_temp_variable = { temp_v = temp_class }
    remove_from_array = {
        array = PRC_class_array
        value = temp_class
    }
    custom_effect_tooltip = PRC_class_removal_tt

    PRC_class_status_change = yes
}
PRC_class_addition = {
    set_temp_variable = { temp_v = temp_class }
    add_to_array = {
        array = PRC_class_array
        value = temp_class
        #index = temp_class
    }
    if = {
        limit = {
            check_variable = { 
                var = PRC_class_weight_array^temp_class
                value = 25 
                compare = less_than 
            }
        }
        add_to_array = { PRC_marginal_class_array = temp_class }
        set_temp_variable = { PRC_temp_marginal_class = temp_class }
    }
    else_if = {
        limit = {
            check_variable = { 
                var = PRC_class_weight_array^temp_class
                value = 25 
                compare = greater_than_or_equals 
            }
            check_variable = { 
                var = PRC_class_weight_array^temp_class
                value = 70 
                compare = less_than 
            }
        }
        add_to_array = { PRC_general_class_array = temp_class }
        set_temp_variable = { PRC_temp_general_class = temp_class }
    }
    else_if = {
        limit = {
            check_variable = { 
                var = PRC_class_weight_array^temp_class
                value = 70 
                compare = greater_than_or_equals 
            }
        }
        add_to_array = { PRC_major_class_array = temp_class }
        set_temp_variable = { PRC_temp_major_class = temp_class }
    }
    custom_effect_tooltip = PRC_class_addition_tt

    PRC_class_status_change = yes
}
PRC_Pop_Unlock_effect = {
	set_country_flag = PRC_Pop_visible_flag

	set_country_flag = PRC_Major_Pop1_flag
	set_variable = {
		PRC_Pop1_Attitude = -20
	}
	set_variable = {
		PRC_Pop1_Influence = 64
	}
	set_country_flag = PRC_Major_Pop2_flag
	set_variable = {
		PRC_Pop2_Attitude = 30
	}
	set_variable = {
		PRC_Pop2_Influence = 76
	}
	set_country_flag = PRC_Major_Pop3_flag
	set_variable = {
		PRC_Pop3_Attitude = 30
	}
	set_variable = {
		PRC_Pop3_Influence = 64
	}
	set_country_flag = PRC_Ordinary_Pop4_flag
	set_variable = {
		PRC_Pop4_Attitude = -40
	}
	set_variable = {
		PRC_Pop4_Influence = 20
	}
	set_country_flag = PRC_Ordinary_Pop5_flag
	set_variable = {
		PRC_Pop5_Attitude = 0
	}
	set_variable = {
		PRC_Pop5_Influence = 40
	}
	set_country_flag = PRC_Ordinary_Pop6_flag
	set_variable = {
		PRC_Pop6_Attitude = -10
	}
	set_variable = {
		PRC_Pop6_Influence = 40
	}
	set_country_flag = PRC_Ordinary_Pop7_flag
	set_variable = {
		PRC_Pop7_Attitude = 20
	}
	set_variable = {
		PRC_Pop7_Influence = 52
	}
	set_country_flag = PRC_Ordinary_Pop8_flag
	set_variable = {
		PRC_Pop8_Attitude = 10
	}
	set_variable = {
		PRC_Pop8_Influence = 24
	}
	set_country_flag = PRC_Ordinary_Pop9_flag
	set_variable = {
		PRC_Pop9_Attitude = 10
	}
	set_variable = {
		PRC_Pop9_Influence = 32
	}
	set_country_flag = PRC_Ordinary_Pop10_flag
	set_variable = {
		PRC_Pop10_Attitude = 10
	}
	set_variable = {
		PRC_Pop10_Influence = 20
	}
	set_country_flag = PRC_Ordinary_Pop11_flag
	set_variable = {
		PRC_Pop11_Attitude = 10
	}
	set_variable = {
		PRC_Pop11_Influence = 32
	}
	set_country_flag = PRC_Marginalized_Pop12_flag
	set_variable = {
		PRC_Pop12_Attitude = 10
	}
	set_variable = {
		PRC_Pop12_Influence = 4
	}
	set_country_flag = PRC_Marginalized_Pop13_flag
	set_variable = {
		PRC_Pop13_Attitude = 10
	}
	set_variable = {
		PRC_Pop13_Influence = 8
	}
	set_country_flag = PRC_Marginalized_Pop14_flag
	set_variable = {
		PRC_Pop14_Attitude = 10
	}
	set_variable = {
		PRC_Pop14_Influence = 8
	}
	PRC_Pop_Update_effect = yes
}
PRC_Pop_addition_effect = {
	meta_effect = {
		text = {
			if = {
				limit = {
					check_variable = {
						var = PRC_Pop[PRC_Pop_Serial_Num1]_Influence
						value = 60
						compare = greater_than_or_equals
					}
				}
				set_temp_variable = { PRC_Pop_group_temp = 1 }
				set_country_flag = PRC_Major_Pop[PRC_Pop_temp_text]_flag
			}
			else_if = {
				limit = {
					check_variable = {
						var = PRC_Pop[PRC_Pop_Serial_Num1]_Influence
						value = 25
						compare = greater_than_or_equals
					}
					check_variable = {
						var = PRC_Pop[PRC_Pop_Serial_Num1]_Influence
						value = 60
						compare = less_than
					}
				}
				set_temp_variable = { PRC_Pop_group_temp = 2 }
				set_country_flag = PRC_Ordinary_Pop[PRC_Pop_temp_text]_flag
			}
			else_if = {
				limit = {
					check_variable = {
						var = PRC_Pop[PRC_Pop_Serial_Num1]_Influence
						value = 25
						compare = less_than
					}
				}
				set_temp_variable = { PRC_Pop_group_temp = 3 }
				set_country_flag = PRC_Marginalized_Pop[PRC_Pop_temp_text]_flag
			}
		}
		PRC_Pop_temp_text = "[?PRC_Pop_n_temp]"
	}	
	custom_effect_tooltip = PRC_Pop_addition_tt
	PRC_Pop_Update_effect = yes
}
PRC_Pop_removal_effect = {
	custom_effect_tooltip = PRC_Pop_removal_tt
	meta_effect = {
		text = {
			clr_country_flag = PRC_Major_Pop[PRC_Pop_temp_text]_flag
			clr_country_flag = PRC_Ordinary_Pop[PRC_Pop_temp_text]_flag
			clr_country_flag = PRC_Marginalized_Pop[PRC_Pop_temp_text]_flag
		}
		PRC_Pop_temp_text = "[?PRC_Pop_n_temp]"
	}	
	PRC_Pop_Update_effect = yes
}
PRC_Pop_attitude_effect = {
	custom_effect_tooltip = PRC_Pop_attitude_tt
	meta_effect = {
		text = {
			add_to_variable = {
				var = PRC_Pop[PRC_Pop_temp_text]_attitude
				value = PRC_Pop_a_temp
			}
		}
		PRC_Pop_temp_text = "[?PRC_Pop_n_temp]"
	}	
	PRC_Pop_Update_effect = yes
}
PRC_Pop_influence_effect = {
	custom_effect_tooltip = PRC_Pop_influcence_tt
	meta_effect = {
		text = {
			if = {
				limit = {
					check_variable = {
						var = PRC_Pop[PRC_Pop_temp_text]_Influence
						value = 60
						compare = greater_than_or_equals
					}
				}
				set_temp_variable = { PRC_Pop_group_temp1 = 1 }
			}
			else_if = {
				limit = {
					check_variable = {
						var = PRC_Pop[PRC_Pop_temp_text]_Influence
						value = 25
						compare = greater_than_or_equals
					}
					check_variable = {
						var = PRC_Pop[PRC_Pop_temp_text]_Influence
						value = 60
						compare = less_than
					}
				}
				set_temp_variable = { PRC_Pop_group_temp1 = 2 }
			}
			else_if = {
				limit = {
					check_variable = {
						var = PRC_Pop[PRC_Pop_temp_text]_Influence
						value = 25
						compare = less_than
					}
				}
				set_temp_variable = { PRC_Pop_group_temp1 = 3 }
			}




			add_to_variable = {
				var = PRC_Pop[PRC_Pop_temp_text]_Influence
				value = PRC_Pop_i_temp
			}




			if = {
				limit = {
					check_variable = {
						var = PRC_Pop[PRC_Pop_temp_text]_Influence
						value = 60
						compare = greater_than_or_equals
					}
					NOT = { has_country_flag = PRC_Major_Pop[PRC_Pop_temp_text]_flag }
				}
				set_country_flag = PRC_Major_Pop[PRC_Pop_temp_text]_flag
				clr_country_flag = PRC_Ordinary_Pop[PRC_Pop_temp_text]_flag
				clr_country_flag = PRC_Marginalized_Pop[PRC_Pop_temp_text]_flag
				set_temp_variable = { PRC_Pop_group_temp = 1 }
				custom_effect_tooltip = PRC_Pop_group_change_tt
			}
			else_if = {
				limit = {
					check_variable = {
						var = PRC_Pop[PRC_Pop_temp_text]_Influence
						value = 60
						compare = less_than
					}
					check_variable = {
						var = PRC_Pop[PRC_Pop_temp_text]_Influence
						value = 25
						compare = greater_than_or_equals
					}
					NOT = { has_country_flag = PRC_Ordinary_Pop[PRC_Pop_temp_text]_flag }
				}
				clr_country_flag = PRC_Major_Pop[PRC_Pop_temp_text]_flag
				set_country_flag = PRC_Ordinary_Pop[PRC_Pop_temp_text]_flag
				clr_country_flag = PRC_Marginalized_Pop[PRC_Pop_temp_text]_flag
				set_temp_variable = { PRC_Pop_group_temp = 2 }
				
			}
			else_if = {
				limit = {
					check_variable = {
						var = PRC_Pop[PRC_Pop_temp_text]_Influence
						value = 25
						compare = less_than
					}
				    NOT = { has_country_flag = PRC_Marginalized_Pop[PRC_Pop_temp_text]_flag }
				}
				clr_country_flag = PRC_Major_Pop[PRC_Pop_temp_text]_flag
				clr_country_flag = PRC_Ordinary_Pop[PRC_Pop_temp_text]_flag
				set_country_flag = PRC_Marginalized_Pop[PRC_Pop_temp_text]_flag
				set_temp_variable = { PRC_Pop_group_temp = 3 }
				custom_effect_tooltip = PRC_Pop_group_change_tt
			}

			if = {
				limit = {
					NOT = {
						check_variable = { PRC_Pop_group_temp1 = PRC_Pop_group_temp }
					}
				}
				custom_effect_tooltip = PRC_Pop_group_change_tt
			}
		}
		PRC_Pop_temp_text = "[?PRC_Pop_n_temp]"
	}
	PRC_Pop_Update_effect = yes
}