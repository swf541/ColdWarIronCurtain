federation_calculator = {
	every_country = {
		clr_country_flag = federation_member #Reset federation member status, will be readded if found
		clr_country_flag = common_market_member #Reset common market member status, will be readded if found
	}
	
	#EUROPEAN UNION#
	set_variable = { global.federation_european_union_entrance = 0 }
	set_variable = { global.federation_european_union_count = 0 }
	set_variable = { global.federation_european_union_entrance = 0 }
	every_country = {
		limit = {
			has_dynamic_modifier = {
				modifier = federation_european_union
			}
		}
		add_to_variable = { global.federation_european_union_count = 1 } #Adds up all european union members
		set_country_flag = federation_member
	}
	
	if = {
		limit = {
			has_global_flag = European_PP
		}
		set_variable = { global.federation_european_union_beta = -0.001 } #-0.1% per country
		multiply_variable = { global.federation_european_union_beta = global.federation_european_union_count }
	}

	if = {
		limit = {
			has_global_flag = PanEuropean_ResearchSharing

			has_dynamic_modifier = {
				modifier = federation_european_union
			}
		}
		add_to_tech_sharing_group = PanEuropean_Research
	}

	if = {
		limit = {
			has_global_flag = European_Trade
		}
		set_variable = { global.federation_european_union_phi = 0.025 } #2.5% per country
		multiply_variable = { global.federation_european_union_phi = global.federation_european_union_count }
	}

	if = {
		limit = {
			has_global_flag = PanEuropean_Food
		}
		set_variable = { global.federation_european_union_food = 0.01 } #1% per country
		multiply_variable = { global.federation_european_union_food = global.federation_european_union_count }
	}

	
	if = {
		limit = {
			has_global_flag = PanEuropean_license 
		}
		set_variable = { global.federation_european_union_alpha = 0.01 } #1% per country
		multiply_variable = { global.federation_european_union_alpha = global.federation_european_union_count }
	}

	if = { 
		limit = {
			has_global_flag = PanEuropean_ResearchGrants
		}
		set_variable = { global.federation_european_union_theta = 0.0025 } #0.25% per country
		multiply_variable = { global.federation_european_union_theta = global.federation_european_union_count }
	}
	

	if = {
		limit = {
			has_global_flag = PanEuropean_Construction
		}
		set_variable = { global.federation_european_union_gamma = 0.005 } #0.5% per country
		multiply_variable = { global.federation_european_union_gamma = global.federation_european_union_count }


		set_variable = { global.federation_european_consumer_goods_cost = 0.1 } #always 10%

	}
	
	if = {
		limit = {
			has_global_flag = PanEuropean_Efficiency
		}
		set_variable = { global.federation_european_union_delta = 0.0025 } #0.25% per country
		multiply_variable = { global.federation_european_union_delta = global.federation_european_union_count }
	}
	
	if = { 
		limit = {
			has_global_flag = PanEuropean_Leader
		}
		set_variable = { global.federation_european_union_leader_level_increase = 1 } #always 1
	}
	
}