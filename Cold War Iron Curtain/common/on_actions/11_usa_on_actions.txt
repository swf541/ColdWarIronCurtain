on_actions = {
	# ROOT is capitulated country, FROM is winner

	on_capitulation = {
		effect = {
			#### moved from 00_on_actions.txt ####
			if = {
				limit = {
					NOT = {
						tag = PDG
					}
				}
				news_event = { id = country_capitulated.0 days = 0 }
			}
			if = {
				limit = {
					FROM = { TAG = IRQ has_country_flag = IRAN_IRAQ_WAR_PREP }
					ROOT = { TAG = PER }
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				news_event = Iranian_Iraq_War.8
				transfer_state = 413
				transfer_state = 1328
				white_peace = PER
				413 = { add_core_of = IRQ }
				1328 = { add_core_of = IRQ }
				PER = {
					set_politics = {
						ruling_party = trotskyism
						elections_allowed = no
					}
				}
			}
			if = {
				limit = {
					FROM = { TAG = PER }
					ROOT = { TAG = IRQ has_country_flag = IRAN_IRAQ_WAR_PREP }
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				news_event = Iranian_Iraq_War.7
				white_peace = IRQ
				puppet = IRQ
				IRQ = {
					set_politics = {
						ruling_party = radical_shiaism
						elections_allowed = no
					}
				}
			}
			if = {
				limit = {
					FROM = {
						OR = {
							original_tag = PDG
							is_in_faction_with = PDG
						}
					}
					ROOT = { TAG = GRE }
				}
				PDG = {
					white_peace = GRE
					annex_country = {
						target = GRE
						transfer_troops = no
					}
				}
				SOV = {
					set_autonomy = {
						target = PDG
						autonomous_state = autonomy_easternbloc
						freedom_level = 0.4
					}
				}
			}
			# Korean War - North wins
			if = {
				limit = {
					ROOT = { TAG = KOR }
					OR = {
						FROM = { TAG = KPA }
						FROM = { TAG = PRC }
						FROM = { TAG = SOV }
					}
				}
				log = "[GetDateText]: [Root.GetTag]: On Action Capitulation for Korean War: North wins"
				SOV = {
					white_peace = KOR
					white_peace = USA
					white_peace = CHI
				}
				PRC = {
					country_event = korean_surrender.4
					white_peace = KOR
					white_peace = USA
					if = { limit = { has_global_flag = chinese_civil_war_over }
						white_peace = CHI
						dismantle_faction = yes
					}
				}
				USA = {
					white_peace = SOV
					white_peace = PRC
					dismantle_faction = yes
				}
				KOR = {
					country_event = korean_surrender.5
					every_owned_state = {
						limit = { is_core_of = KOR }
						add_core_of = KPA
					}
				}
				CHI = {
					white_peace = SOV
					if = { limit = { has_global_flag = chinese_civil_war_over }
						white_peace = KPA
						white_peace = PRC
						dismantle_faction = yes
					}
				}
				KPA = {
					country_event = korean_surrender.3
					white_peace = USA
					if = { limit = { has_global_flag = chinese_civil_war_over }
						white_peace = CHI
						dismantle_faction = yes
					}
					leave_faction = yes
					annex_country = { target = KOR transfer_troops = yes }
					set_global_flag = KOREA_CEASEFIRE_UN
					clr_global_flag = korean_war
				}
				
			}
			# Korean War - South wins
			if = {
				limit = {
					FROM = { tag = KOR }
					OR = {
						AND = {
							ROOT = { tag = PRC }
							PRC = { has_idea = korean_war }
						}
						ROOT = { tag = KPA }
					}
				}
				log = "[GetDateText]: [Root.GetTag]: On Action Capitulation for Korean War: South wins"
				SOV = {
					white_peace = KOR
					white_peace = USA
					white_peace = CHI
				}
				PRC = {
					white_peace = KOR
					white_peace = USA
					if = { limit = { has_global_flag = chinese_civil_war_over }
						white_peace = CHI
					}
				}
				USA = {
					white_peace = SOV
					white_peace = PRC
					dismantle_faction = yes
				}
				CHI = {
					white_peace = SOV
					if = { limit = { has_global_flag = chinese_civil_war_over }
						white_peace = KPA
						white_peace = PRC
						dismantle_faction = yes
					}
				}
				KPA = {
					if = { limit = { has_global_flag = chinese_civil_war_over }
						white_peace = KOR
						white_peace = USA
						white_peace = CHI
						dismantle_faction = yes
					}
					every_owned_state = {
						limit = { is_core_of = KPA }
						add_core_of = KOR
					}
				}
				KOR = {
					white_peace = PRC
					if = { limit = { has_global_flag = chinese_civil_war_over }
						white_peace = KPA
						dismantle_faction = yes
					}
					white_peace = SOV
					news_event = korea.12
					annex_country = { target = KPA transfer_troops = yes }
					set_global_flag = KOREA_CEASEFIRE_UN
					clr_global_flag = korean_war
				}
			}
			if = {
				limit = {
					FROM = { tag = NGA }
					ROOT = { tag = BFR }
				}
				news_event = Biafra_War.3
			}
			##### end of moved from 00_on_actions.txt #####

			# PRC capitulates against CHI or USA
			if = {
				limit = {
					ROOT = {
						tag = PRC
						OR = {
							has_country_flag = american_invasion_prc_49
							has_global_flag = roc_rebound_shanghai
							date < 1951.6.1
						}
					}
					FROM = {
						OR = {
							tag = USA
							tag = CHI
						}
					}
				}
				PRC_Lose_CCW = yes
			}
			####

			if = {
				limit = {
					ROOT = {
						tag = TIB
					}
					FROM = {
						tag = PRC
                        has_country_flag = Tibet_Invasion_1
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
                TIB = {
                    country_event = PRC_Tibet.6
                    set_country_flag = Lhasa_Uprising_Precursor
                }
				white_peace = TIB
				white_peace = RAJ
				white_peace = KAS
				RAJ = {
					dismantle_faction = yes
				}
			}
			if = {
				limit = {
					ROOT = {
						tag = TIB
					}
					FROM = {
						tag = PRC
                        has_country_flag = tib_uprising
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
                news_event = PRC_TIBETAN.7
                annex_country = { target = TIB transfer_troops = no }
			}

			if = {
				limit = {
					ROOT = {
						tag = VIN
					}
					FROM = {
						OR = {
							tag = FRA
							tag = VIE
							tag = USA
						}
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				VIE = {
					annex_country = {
						target = VIN
						transfer_troops = no
					}
				}
			}
			if = {
				limit = {
					ROOT = {
						tag = SYR
					}
					FROM = {
						tag = IRQ
                        has_country_flag = Syrian_Intervention_IRQ
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				create_country_leader = {
					name = "Abd al-Ilah"
					picture = "abdallah.dds"
					ideology = monarchist
				}
				set_politics = {
					ruling_party = monarchism
					elections_allowed = no
				}
                IRQ = {
                    set_autonomy = {
                        target = SYR
                        autonomy_state = autonomy_associated_state
                    }
                    news_event = CIA_SYRIA.57
                }
				load_focus_tree = generic_focus
				every_enemy_country = {
					white_peace = ROOT
				}
			}
			if = {
				limit = {
					ROOT = {
						tag = PER
						has_country_flag = Ajax_Invasion_Outcome
					}
					FROM = {
						OR = {
							tag = USA
							tag = ENG
						}
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				set_politics = {
					ruling_party = monarchism
					elections_allowed = no
				}
				load_focus_tree = generic_focus
				every_enemy_country = {
					white_peace = ROOT
				}
			}

			if = {
				limit = {
					ROOT = {
						tag = INS
					}
					FROM = {
						tag = INO
						has_country_flag = PRRI_UPRISING
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				INO = {
					annex_country = {
						target = INS
						transfer_troops = no
					}
					news_event = Sumatran_Revolt.4
				}
			}
			if = {
				limit = {
					ROOT = {
						tag = INO
						has_country_flag = PRRI_UPRISING
					}
					FROM = {
						tag = INS
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				INS = {
					annex_country = {
						target = INO
						transfer_troops = no
					}
					news_event = Sumatran_Revolt.5
				}
			}

			if = {
				limit = {
					ROOT = {
						tag = INO
						has_country_flag = Sumatra_Invasion_Outcome
					}
					FROM = {
						tag = USA
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				INS = {
					annex_country = {
						target = INO
						transfer_troops = no
					}
				}
			}

			if = {
				limit = {
					ROOT = {
						tag = SYR
						has_country_flag = Syria_Mulilateral_Invasion_Outcome
					}
					FROM = {
						OR = {
							tag = USA
							tag = TUR
							tag = IRQ
						}
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				create_country_leader = {
					name = "Umar Kabbani"
					picture = "Umar_Kabbani.dds"
					ideology = military_junta
				}
				set_politics = {
					ruling_party = neutrality
					elections_allowed = no
				}
				load_focus_tree = generic_focus
				every_enemy_country = {
					white_peace = ROOT
				}
				USA = {
					dismantle_faction = yes
				}
			}
			if = {
				limit = {
					ROOT = {
						tag = SYR
					}
					FROM = {
						tag = TUR
                        has_country_flag = Syrian_Intervention_TUR
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				create_country_leader = {
					name = "Umar Kabbani"
					picture = "Umar_Kabbani.dds"
					ideology = military_junta
				}
				set_politics = {
					ruling_party = neutrality
					elections_allowed = no
				}
                TUR = {
                    set_autonomy = {
                        target = SYR
                        autonomy_state = autonomy_associated_state
                    }
                    news_event = CIA_SYRIA.60
                    894 = {
                        add_core_of = TUR
                    }
                    677 = {
                        add_core_of = TUR
                    }
                    810 = {
                        add_core_of = TUR
                    }
                    777 = {
                        add_core_of = TUR
                    }
                    680 = {
                        add_core_of = TUR
                    }
                    transfer_state = 894
                    transfer_state = 677
                    transfer_state = 810
                    transfer_state = 777
                    transfer_state = 680
                }
				load_focus_tree = generic_focus
				every_enemy_country = {
					white_peace = ROOT
				}
			}
			if = {
				limit = {
					ROOT = {
						tag = EGY
						has_country_flag = FF_Invasion_Outcome
					}
					FROM = {
						tag = USA
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				set_politics = {
					ruling_party = nationalist
					elections_allowed = no
				}
				load_focus_tree = generic_focus
				every_enemy_country = {
					white_peace = ROOT
				}
			}
			if = {
				limit = {
					ROOT = {
						tag = GUA
						has_country_flag = PBSUCCESS_Invasion_Outcome
					}
					FROM = {
						tag = USA
					}
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				every_enemy_country = {
					white_peace = ROOT
				}
				USA = {
                    set_autonomy = {
                        target = SYR
                        autonomy_state = autonomy_associated_state
                    }
				}
				set_politics = {
					ruling_party = conservative
					elections_allowed = no
				}
			}

			# swf, please see if this part is actually needed, it was firing after the korean war ended with KOR victory,
			# if KOR then attacked PRC, this triggered on PRC capitulation
			# I added check for flag korean_war, which fixes this case, but i don't think any of this is needed
			# since it's already handled at the start of this file (or am i missing something? - Harain
			if = {
				limit = {
					has_global_flag = korean_war
					FROM = {
						OR = {
							is_in_faction_with = KOR
							tag = KOR
						}
					}
					ROOT = { tag = PRC }
				}
				log = "  [GetDateText]: [ROOT.GetTag]: On Action Capitulation: [FROM.GetTag] victory against [ROOT.GetTag]"
				PRC = {
					every_enemy_country = {
						white_peace = PRC
					}
				}
				SOV = {
					white_peace = KOR
					white_peace = USA
					white_peace = CHI
				}
				PRC = {
					white_peace = KOR
					white_peace = USA
					white_peace = CHI
				}
				USA = {
					white_peace = SOV
					white_peace = PRC
					dismantle_faction = yes
				}
				CHI = {
					white_peace = SOV
					white_peace = KPA
					white_peace = PRC
					dismantle_faction = yes
				}
				KPA = {
					white_peace = KOR
					white_peace = USA
					white_peace = CHI
					dismantle_faction = yes
				}
				KOR = {
					white_peace = SOV
					white_peace = PRC
					white_peace = KPA
					dismantle_faction = yes
					news_event = korea.12
					annex_country = { target = KPA transfer_troops = yes }
					set_global_flag = KOREA_CEASEFIRE_UN
					clr_global_flag = korean_war
					transfer_state = 1325
					transfer_state = 1326
				}
			}


		}
	}
}
#Add Missions for Turkey/Iraq for that War
